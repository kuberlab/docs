



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.1">
    
    
      
        <title>Train CIFAR-10 Model from scratch using Kibernetika.AI - Kibernetika Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-36723568-3", "mkdocs.org")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#train-cifar-10-model-from-scratch-using-kibernetikaai" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Kibernetika Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Kibernetika Documentation
            </span>
            <span class="md-header-nav__topic">
              Train CIFAR-10 Model from scratch using Kibernetika.AI
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Kibernetika Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Kibernetika Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Settings
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Settings
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../settings/user/" title="User" class="md-nav__link">
      User
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../settings/organization/" title="Organization" class="md-nav__link">
      Organization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../settings/billing/" title="Billing" class="md-nav__link">
      Billing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Projects
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Projects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/create-new-project/" title="Create New Project" class="md-nav__link">
      Create New Project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/working-with-projects/" title="Working With Projects" class="md-nav__link">
      Working With Projects
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Datasets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Datasets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../datasets/datasets/" title="Datasets Management" class="md-nav__link">
      Datasets Management
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Models
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../models/models/" title="Models Management" class="md-nav__link">
      Models Management
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Serving
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Serving
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../serving/serving-start/" title="Start serving" class="md-nav__link">
      Start serving
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../serving/kibernetika-serving/" title="Serving tool" class="md-nav__link">
      Serving tool
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Resources
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Resources
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../resources/kibernetika-storage/" title="Storage" class="md-nav__link">
      Storage
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/kdataset/" title="kdataset" class="md-nav__link">
      kdataset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../serving/kibernetika-serving/" title="kibernetika-serving" class="md-nav__link">
      kibernetika-serving
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/python-mlboardclient/" title="python-mlboardclient" class="md-nav__link">
      python-mlboardclient
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/project-page/" title="Project Page Tour" class="md-nav__link">
      Project Page Tour
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/openvino/" title="Using OpenVINO" class="md-nav__link">
      Using OpenVINO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/openvino-1/" title="Using OpenVINO New" class="md-nav__link">
      Using OpenVINO New
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10" checked>
    
    <label class="md-nav__link" for="nav-10">
      HowTo
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        HowTo
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Train CIFAR-10 Model from scratch using Kibernetika.AI
      </label>
    
    <a href="./" title="Train CIFAR-10 Model from scratch using Kibernetika.AI" class="md-nav__link md-nav__link--active">
      Train CIFAR-10 Model from scratch using Kibernetika.AI
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-tensorflow-project" title="Install Tensorflow project" class="md-nav__link">
    Install Tensorflow project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-dataset" title="Prepare Dataset" class="md-nav__link">
    Prepare Dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#standard-train-model" title="Standard Train model" class="md-nav__link">
    Standard Train model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#distributed-training" title="Distributed training" class="md-nav__link">
    Distributed training
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-of-tf_conf-command" title="Usage of tf_conf command" class="md-nav__link">
    Usage of tf_conf command
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../object-detection-pets/" title="Train model for object-detecion using object-detection API" class="md-nav__link">
      Train model for object-detecion using object-detection API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/about/" title="Copyright" class="md-nav__link">
      Copyright
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Misc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12-1" type="checkbox" id="nav-12-1">
    
    <label class="md-nav__link" for="nav-12-1">
      python-mlboardclent
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-12-1">
        python-mlboardclent
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/python-mlboardclient/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/python-mlboardclient/getting-started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/python-mlboardclient/datasets-and-models/" title="Datasets and Models" class="md-nav__link">
      Datasets and Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/python-mlboardclient/dive-into-tasks/" title="Dive into tasks" class="md-nav__link">
      Dive into tasks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/python-mlboardclient/tf-conf-gen/" title="TensorFlow distribute configuration" class="md-nav__link">
      TensorFlow distribute configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/python-mlboardclient/upload-model/" title="Uploading a model" class="md-nav__link">
      Uploading a model
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tools/python-mlboardclient/work-with-tasks/" title="Working with tasks" class="md-nav__link">
      Working with tasks
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-tensorflow-project" title="Install Tensorflow project" class="md-nav__link">
    Install Tensorflow project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-dataset" title="Prepare Dataset" class="md-nav__link">
    Prepare Dataset
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#standard-train-model" title="Standard Train model" class="md-nav__link">
    Standard Train model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#distributed-training" title="Distributed training" class="md-nav__link">
    Distributed training
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-of-tf_conf-command" title="Usage of tf_conf command" class="md-nav__link">
    Usage of tf_conf command
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="train-cifar-10-model-from-scratch-using-kibernetikaai">Train CIFAR-10 Model from scratch using Kibernetika.AI<a class="headerlink" href="#train-cifar-10-model-from-scratch-using-kibernetikaai" title="Permanent link">#</a></h1>
<p>This tutorial shows basic steps required to train CIFAR-10 model using original source code from <a href="https://github.com/tensorflow/models/tree/master/tutorials/image/cifar10_estimator">https://github.com/tensorflow/models/tree/master/tutorials/image/cifar10_estimator</a></p>
<h3 id="install-tensorflow-project">Install Tensorflow project<a class="headerlink" href="#install-tensorflow-project" title="Permanent link">#</a></h3>
<ul>
<li>Start creating a new project in your Workspace. <a href="../../projects/create-new-project/">More details</a></li>
<li>Set Tensorflow version 1.9.0</li>
<li>Set source location to <strong>https://github.com/tensorflow/models/tree/master/tutorials/image/cifar10_estimator</strong></li>
</ul>
<p><em>Notes:</em></p>
<p>In this case, <strong>https://github.com/tensorflow/models</strong> will be used as a Source repository and <strong>models/tutorials/image/cifar10_estimator</strong> as a subpath:</p>
<p><img alt="" src="../../img/cifar-10/cifar-3.png" /></p>
<p>Contents of this repository dir will be visible inside Jupyter or running Job under <strong>$SRC_DIR</strong> path, usually SRC_DIR is an alias for <strong>/norebooks/src</strong></p>
<h3 id="prepare-dataset">Prepare Dataset<a class="headerlink" href="#prepare-dataset" title="Permanent link">#</a></h3>
<p>First, we need to upload CIFAR-10 to Kibernetika. There are two options to upload data.</p>
<ol>
<li>Upload data to some project directory, for example to <strong>$DATA_DIR</strong>.</li>
<li>Upload data to Kibernetika DataSet Catalog.</li>
</ol>
<p>The second option is preferable as it will allow you to track versions of your dataset and also use the dataset in other projects.</p>
<p>Following steps required to upload dataset to catalog:</p>
<ul>
<li>Create new task <strong>upload-dataset</strong> with resource <strong>worker</strong> for dataset uploading. Inside the project, clone an existing task or create a new one from scratch.</li>
<li>After creating the task we are ready to define the execution command for uploading. The CIFAR-10 project already has code for that. Our task definition looks like:</li>
</ul>
<blockquote>
<p><img alt="" src="../../img/cifar-10/cifar-1.png" /></p>
</blockquote>
<p>Basically we defined the following parameters:</p>
<ul>
<li>Execution Directory: <strong>$SRC_DIR</strong> refers to the location our CIFAR-10 source code is</li>
<li>Execution Command:<blockquote>
<p><code>mkdir /tmp/cifar-10 &amp;&amp; python generate_cifar10_tfrecords.py --data-dir=/tmp/cifar-10 &amp;&amp; cd /tmp/cifar-10 &amp;&amp;  kdataset push $WORKSPACE_NAME cifar-10:1.0.0 --create</code></p>
</blockquote>
</li>
<li>Ensure that Source is mounted to your task. Open "Advanced" section at the bottom of form and check option "Default volume mapping" or add needed volume manually.</li>
</ul>
<p>During running of the new task the following steps will be executed:</p>
<ul>
<li>Make temporary directory <strong>/tmp/cifar-10</strong></li>
<li>Use <strong>generate_cifar10_tfrecords.py</strong> to upload dataset to <strong>/tmp/cifar-10</strong></li>
<li>Change current directory <strong>/tmp/cifar-10</strong></li>
<li>Push <strong>cifar-10</strong> dataset to current workspace DataSet catalog (use environment variable <strong>$WORKSPACE_NAME</strong> for current workspace) as version 1.0.0. Option <strong>--create</strong> means create dataset if it doesn’t exist.</li>
</ul>
<p>After execution <strong>upload-dataset</strong>  we can refer our <strong>data</strong> directory to the created dataset. Change definition <strong>data</strong> volume in the <strong>Sources</strong> tab to point it to the newly created dataset:</p>
<p><img alt="" src="../../img/cifar-10/cifar-2.png" /></p>
<p><em>Notes:</em></p>
<ul>
<li><strong>kdataset</strong> command is always present in Kibernetika environment</li>
<li>you also could push dataset to catalog directly using python script:</li>
</ul>
<pre><code class="python">from mlboardclient.api import client
mlboard = client.Client()
mlboard.datasets.push(
    os.environ.get('WORKSPACE_NAME'),
    'cifar-10',
    '1.0.0',
    '/tmp/cifar-10',
    create=True,
)
</code></pre>

<h3 id="standard-train-model">Standard Train model<a class="headerlink" href="#standard-train-model" title="Permanent link">#</a></h3>
<p>To start training, we need to configure resource <strong>worker</strong> in task <strong>standalone</strong> to train the model.</p>
<ul>
<li>Set execution directory to <strong>$SRC_DIR</strong></li>
<li>Set execution command to:<blockquote>
<p><code>python cifar10_main.py --num-gpus=$GPU_COUNT --train-steps=1000  --data-dir=$DATA_DIR --job-dir=$TRAINING_DIR/$BUILD_ID</code></p>
</blockquote>
</li>
<li>Set required <strong>GPU</strong> count in the <strong>Resources</strong> section</li>
<li>Start task</li>
</ul>
<p><em>Notes:</em></p>
<ul>
<li><strong>$TRAINING_DIR</strong> is an alias for preconfigured training directory, see <strong>Sources</strong> tab</li>
<li><strong>$BUILD_ID</strong> is an alias for sequential job id, every running job has a unique id</li>
<li><strong>$GPU_COUNT</strong> is an alias for number of GPU allocated for execution on one compute node</li>
</ul>
<p>You can see execution logs in the <strong>Jobs</strong> tab. Use <strong>Tensorboard</strong> tab to see your training progress. The result of model training is available under training directory <strong>$TRAINING_DIR/$BUILD_ID</strong> (usually <strong>/notebooks/training/1,2…</strong>).</p>
<h3 id="distributed-training">Distributed training<a class="headerlink" href="#distributed-training" title="Permanent link">#</a></h3>
<blockquote>
<p><strong>ATTENTION:</strong> CIFAR-10 Tensorflow original model is based on tf.contrib.learn which was deprecated since Tensorflow 1.7 and distributed configuration is not compatible with newer tensorflow version. We recommend migrating your code to Tensorflow Estimators. In the Kibernetika platform you can use distributed training for both old and new style models, see details below.</p>
</blockquote>
<p>First, we need to define resources that will be used for distributed training, e.g. workers and parameter servers.</p>
<ul>
<li>Change <strong>parallel/worker</strong> Execution Command to:<blockquote>
<p><code>TF_CONFIG=$(tf_conf worker --chief_name master) python cifar10_main.py --num-gpus=$GPU_COUNT --train-steps=1000  --data-dir=$DATA_DIR --job-dir=$TRAINING_DIR/$BUILD_ID --sync</code></p>
</blockquote>
</li>
<li>Set <strong>parallel/worker</strong> Replicas Count to 2 or more</li>
<li>Set <strong>parallel/worker</strong> GPU Count to 1</li>
<li>Change <strong>parallel/ps</strong> Execution Command to:<blockquote>
<p><code>TF_CONFIG=$(tf_conf ps --chief_name master) python cifar10_main.py --num-gpus=$GPU_COUNT --train-steps=1000  --data-dir=$DATA_DIR --job-dir=$TRAINING_DIR/$BUILD_ID --sync</code></p>
</blockquote>
</li>
</ul>
<p>Now we are ready to start distributed training. During execution the following process will be started:</p>
<ul>
<li>Two workers, one of them is chief</li>
<li>One Parameter server</li>
</ul>
<p><em>Notes:</em></p>
<ul>
<li>Remove <strong>--sync</strong> options for asynchronous training, see Tensorflow documentation for more details.</li>
<li><strong>tf_conf</strong> command is always present in Kibernetika environment</li>
</ul>
<h3 id="usage-of-tf_conf-command">Usage of <strong>tf_conf</strong> command<a class="headerlink" href="#usage-of-tf_conf-command" title="Permanent link">#</a></h3>
<p><strong>tf_conf</strong> is basic script that helps define the environment for Tensorflow distributed training.</p>
<pre><code>usage: tf_conf [-h] [--worker WORKER] [--ps PS] {worker,ps,eval} [--chief_name CHIEF_NAME]

positional arguments:
{worker,ps,eval}  Set executable role

optional arguments:
-h, --help               show this help message and exit
--worker WORKER          Worker resource name
--ps PS                  PS server resource name
--chief_name CHIEF_NAME  Name for the chief worker. 'chief' for newer Tensorflow version and 'master' for tf.contrib.learn
</code></pre>

<p>Also, you could setup distributed configuration directly in your code:</p>
<pre><code>from mlboardclient import utils
conf = utils.setup_tf_distributed(mode, worker_names='worker', ps_names='ps',chief_name='cheif')
os.environ['TF_CONFIG'] = conf
</code></pre>

<p><em>Notes:</em></p>
<ul>
<li>Please see <strong>link</strong> for more low levels details about distributed training on the Kibernetika platform.</li>
<li>Please see <strong>horovod</strong> for using <strong>Horovod</strong> and <strong>OpenMPI</strong> for distributed training</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../tutorials/openvino-1/" title="Using OpenVINO New" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Using OpenVINO New
              </span>
            </div>
          </a>
        
        
          <a href="../object-detection-pets/" title="Train model for object-detecion using object-detection API" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Train model for object-detecion using object-detection API
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright 2018 Kibernetika Inc.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b806dc00.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>